# list recipes
default:
    @just -f justfile-processing --list --unsorted

# ==== data preprocessing ====

# data preprocessing: mr-pubmed-data.json
[group('data-prep')]
data-prep-mr-pubmed:
    python scripts/python/preprocessing/mr-pubmed-data-prep.py

# special sample involved in the review analysis
[group('data-prep')]
prep-special-sample:
    python scripts/python/preprocessing/prep-special-sample.py

# ==== post-batch processing ====

# Aggregate LLM batch results
[group('data-processing')]
aggregate-llm-batch-results:
    python scripts/python/postprocessing/aggregate-llm-batch-results.py --all

# Process LLM batch results
[group('data-processing')]
process-llm-batch-results:
    python scripts/python/postprocessing/process-llm-aggregated-results.py

# Aggregate OpenAI SP batch results
[group('data-processing')]
aggregate-llm-batch-results-sp:
    python scripts/python/postprocessing/aggregate-llm-batch-results-sp.py --all

# Process OpenAI SP batch results
[group('data-processing')]
process-llm-batch-results-sp:
    python scripts/python/postprocessing/process-llm-aggregated-results-sp.py

# ==== analysis ====

# analysis sample: trial
[group('data-processing')]
analysis-sample-trial:
    python scripts/python/analysis/make-analysis-sample.py --size 20 --seed 42
    python scripts/python/analysis/render-analysis-sample.py --file sample-42-20.json

# analysis sample: formal
[group('data-processing')]
analysis-sample-formal:
    python scripts/python/analysis/make-analysis-sample.py --size 100 --seed 42
    python scripts/python/analysis/render-analysis-sample.py --file sample-42-100.json

# OpenAI SP analysis: all results
[group('data-processing')]
analysis-sample-sp:
    python scripts/python/analysis/make-analysis-sample-sp.py
    python scripts/python/analysis/render-analysis-sample-sp.py --file all-results.json

# vim: filetype=just
